<script lang="ts">
  export let filename: string = "other";

  // 使用正则表达式提取后缀（更健壮）
  $: fileExt = filename ? (filename.match(/\.([^.]+)$/)?.[1]?.toLowerCase() || "") : "";

  // 预定义支持的扩展名集合（便于维护）
  const DOC_EXTS = new Set(["doc", "docx"]);
  const PPT_EXTS = new Set(["ppt", "pptx"]);
  const PDF_EXTS = new Set(["pdf"]);
  const EXCEL_EXTS = new Set(["xls", "xlsx"]);
  const MD_EXTS = new Set(["md"]);
  const TXT_EXTS = new Set(["txt"]);
  const XML_EXTS = new Set(["xml"]);
</script>

{#if DOC_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-8 h-8">
  <path d="M535.119473 0h69.599248v95.247413C729.226717 96.331138 853.614299 93.92286 977.881468 96.331138a40.459078 40.459078 0 0 1 44.914393 45.516463c2.047037 234.566322 0 469.614299 1.204139 703.819379-1.204139 24.082785 2.287865 50.694262-11.318909 72.248354-16.978363 12.041392-38.893697 10.837253-58.761994 12.041392h-349.200376V1023.518344h-72.248354C354.980245 990.886171 177.490122 960.541863 0 928.752587V95.488241C178.33302 63.578551 356.786453 32.511759 535.119473 0z" fill="#2A5699"/>
  <path d="M604.718721 131.010348H988.598307v761.979304H604.718721v-95.247413h302.479774v-48.165569H604.718721v-59.002822h302.479774v-48.16557H604.718721v-59.002822h302.479774v-48.165569H604.718721v-60.206961h302.479774V428.673565H604.718721v-60.206961h302.479774v-46.96143H604.718721v-59.604892h302.479774V214.336783H604.718721zM240.827846 341.373471c22.156162-1.324553 44.19191-2.287865 66.348071-3.492003 15.533396 80.4365 31.30762 160.632173 48.165569 240.827845 13.125118-82.724365 27.695202-165.087488 41.783632-247.571025 23.239887-0.842897 46.479774-2.167451 69.719661-3.612418-26.370649 115.356538-49.369708 231.796802-78.148636 346.430856-19.386642 10.355597-48.165569 0-71.52587 1.204139C301.034807 596.169332 283.093133 517.779868 269.245532 438.667921c-13.606773 76.944497-31.30762 153.16651-46.841016 229.508937-22.39699-1.204139-44.793979-2.528692-67.311383-4.094073-19.266228-104.760113-42.024459-208.918156-60.206962-313.919097 19.868297-0.963311 39.857008-1.806209 60.206962-2.528693 12.041392 75.860771 25.648166 151.360301 36.124177 227.341487 16.135466-77.907808 32.873001-155.695202 49.610536-233.603011z" fill="#ffffff"/>
</svg>
{:else if PPT_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-8 h-8">
  <path d="M968.704 135.168h-430.08v752.64h430.08c15.36 0 26.624-12.288 26.624-26.624V162.816c0-15.36-11.264-27.648-26.624-27.648z" fill="#FF8A65"/>
  <path d="M512 646.144h376.832v53.248H512z m0 107.52h376.832v54.272H512z m161.792-483.328c-89.088 0-161.792 72.704-161.792 161.792C512 521.216 584.704 593.92 673.792 593.92s161.792-72.704 161.792-161.792H673.792V270.336z" fill="#FBE9E7"/>
  <path d="M727.04 216.064v161.792h161.792c0-89.088-72.704-161.792-161.792-161.792z" fill="#FBE9E7"/>
  <path d="M592.896 996.352L28.672 888.832V135.168L592.896 27.648z" fill="#E64A19"/>
  <path d="M319.488 327.68H192.512v368.64h78.848V569.344h40.96c44.032 0 78.848-11.264 104.448-34.816 25.6-22.528 38.912-53.248 38.912-90.112C455.68 366.592 409.6 327.68 319.488 327.68z m-14.336 178.176h-33.792V391.168h33.792c43.008 0 64.512 18.432 64.512 56.32 0 39.936-21.504 58.368-64.512 58.368z" fill="#FFFFFF"/>
</svg>
{:else if PDF_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-8 h-8">
  <path d="M535.198324 0h69.53853v95.276816c124.175945 0.677323 248.351891-1.354647 373.205159 0.677324a40.6394 40.6394 0 0 1 45.154889 45.154889c1.919083 234.579649 0 469.272186 1.128872 703.851835-1.128872 24.044979 2.257744 50.686363-11.288722 72.022049-17.045971 12.417595-38.946092 11.288722-58.814243 11.288722H604.962628v95.276816h-72.925146C354.917429 990.924044 177.458715 960.557381 0 928.723184V95.502591C178.361812 63.555507 356.836512 32.51152 535.198324 0z" fill="#A33639"/>
  <path d="M604.736854 130.949179h383.816558v762.101642h-383.816558v-95.276816h302.42487v-47.638408H604.736854v-59.491567h302.42487V643.457171H604.736854v-60.056002h302.42487v-47.638409H604.736854v-59.491566h302.42487V428.971447H604.736854v-59.830228h302.42487v-47.638408H604.736854V261.898357h302.42487v597.17341H604.736854z" fill="#FFFFFF"/>
  <path d="M645.489141 529.66685h302.424871v47.638409H645.489141zM645.489141 611.510087h302.424871v47.638408H645.489141zM645.489141 693.353324h302.424871v47.638408H645.489141zM596.383199 775.19656h351.530813v47.638409H596.383199z" fill="#A33639" p-id="8499"></path><path d="M180.619557 317.325984c59.265792 2.822181 130.949179-24.044979 180.619557 21.335685 46.961085 58.475582 34.54349 165.831331-35.107927 200.713483-24.722302 12.982031-53.169882 11.288722-80.037041 10.272737v130.949179L180.619557 675.065594c-0.903098-119.208908-1.128872-238.530702 0-357.73961z" fill="#FFFFFF"/>
  <path d="M245.642597 377.720648c21.448572-1.015985 48.089957-5.079925 62.539522 15.578437a82.407673 82.407673 0 0 1 1.467534 73.263808c-12.417595 22.577445-40.526513 20.771249-62.313747 23.367655-2.257744-37.365671-2.03197-74.731342-1.693309-112.2099zM885.713152 379.865505a83.988094 83.988094 0 0 1-48.315732-19.642376 460.57987 460.57987 0 0 0-77.666409 24.835189c-20.3197 36.011024-39.171866 54.411641-55.540514 54.411641a17.384632 17.384632 0 0 1-9.821188-2.596406 19.416602 19.416602 0 0 1-11.288723-17.723294c0-5.870136 1.354647-22.577445 63.329733-49.105942a467.917539 467.917539 0 0 0 34.656377-81.278801c-7.902106-15.691324-24.835189-54.298754-13.094918-73.941131a20.658362 20.658362 0 0 1 20.206813-10.498511 21.900121 21.900121 0 0 1 17.045971 8.466541c8.466542 11.288722 7.789218 36.688347-3.27373 73.376695A196.988204 196.988204 0 0 0 842.70312 338.661669a221.14607 221.14607 0 0 1 41.090949-4.515489c30.705325 0.677323 35.333701 15.014001 34.656377 23.59343 0 22.577445-21.56146 22.577445-32.624407 22.577444z m-185.022159 42.106935l2.257745-0.564436a45.154889 45.154889 0 0 0 23.932091-16.820197 56.443612 56.443612 0 0 0-26.189836 17.384633z m93.357734-200.261934h-2.144858a4.402602 4.402602 0 0 0-2.82218 0.677323 52.492559 52.492559 0 0 0 4.176827 33.866167 53.282769 53.282769 0 0 0 0.790211-34.54349zM790.210561 317.551758v1.24176l-0.677323-0.677324c-5.418587 14.336677-11.288722 28.44758-18.061956 42.332709l1.128872-0.677323V361.239114A346.338 346.338 0 0 1 812.788006 348.595745l-0.677324-0.564436h1.806196a196.310881 196.310881 0 0 1-23.706317-30.479551z m94.599493 34.769265a66.151913 66.151913 0 0 0-18.174843 1.693308 50.686363 50.686363 0 0 0 20.997024 6.660347 26.076949 26.076949 0 0 0 13.885128-1.580422c-0.451549-2.596406-3.273729-6.773233-17.158858-6.773233z" fill="#A33639"/>
</svg>
{:else if EXCEL_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-8 h-8">
  <path d="M943.5 179.7H643.2v55.6h88.5v87.9h-88.5v28h88.5v88h-88.5V468h88.5v83.2h-88.5v33.4h88.5V668h-88.5v33.4h88.5v83.9h-88.5v61.2h300.3c4.7-1.4 8.7-7 11.9-16.7 3.2-9.8 4.8-17.7 4.8-23.8V189.8c0-4.8-1.6-7.7-4.8-8.7-3.9-1-7.9-1.5-11.9-1.4z m-39 605.5h-144v-83.8h144.1l-0.1 83.8z m0-117.2h-144v-83.5h144.1l-0.1 83.5z m0-116.8h-144v-82.9h144.1l-0.1 82.9z m0-112h-144v-87.9h144.1l-0.1 87.9z m0-116.5h-144v-87.4h144.1v88l-0.1-0.6zM63.8 165.8v694.7L592.7 952V72L63.8 166.1v-0.3z m313.5 525.5c-2-5.5-11.5-28.6-28.3-69.6-9.7-23.9-19.7-47.8-29.8-71.6h-0.9l-56.7 135-75.8-5.1 89.8-168-82.4-168 77.3-4.1 51.1 131.5h1l57.7-137.5 79.9-5-95.1 181.9 98 185.5-85.8-5z" fill="#107B0F"/>
</svg>
{:else if MD_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-8 h-8">
  <path d="M1026.257767 346.875125v677.124875H0V46.674203 0.04105h683.733975a190.021888 190.021888 0 0 1 15.065464 13.710804z m-107.633915 34.933815L644.489878 107.674965v274.133975z" fill="#50B05E" p-id="19679"></path><path d="M236.039286 338.993466l-120.154259-55.41792v-19.498897L236.039286 205.497855v29.597274l-86.205652 38.135739v0.738906l86.205652 35.467468z m152.871357-177.132091L298.353658 379.058569h-34.769613l90.310683-217.197194z m151.065144 120.27741l-120.15426 55.41792v-29.474123l86.205653-35.344318v-0.615754l-86.205653-38.25889v-29.392022l120.15426 58.332491z" fill="#FFFFFF"/>
  <path d="M492.603728 881.801724h-55.45897v-263.460894l-83.33213 263.460894h-28.447866l-83.783684-263.460894v263.460894H197.287793v-300.980878h84.892043l63.053277 193.839567 61.944919-193.839567H492.603728z m64.73634 0v-300.980878h110.835839a123.561435 123.561435 0 0 1 98.767047 43.554379 159.562558 159.562558 0 0 1 37.273683 107.469714 154.718621 154.718621 0 0 1-38.382041 106.730808 139.571056 139.571056 0 0 1-109.72748 43.225977z m55.787372-44.334336h45.155342a81.033313 81.033313 0 0 0 61.575466-27.339507 115.802926 115.802926 0 0 0 25.369092-81.361715 123.643536 123.643536 0 0 0-22.167168-74.629465 68.964522 68.964522 0 0 0-58.537743-30.541431h-51.394989z" fill="#FFFFFF"/>
</svg>
{:else if TXT_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-9 h-9">
  <path d="M535.94 71.69h57.58v91.4c108.56 0.61 217.22-1.12 325.68 0.51 23.36-2.23 41.64 15.95 39.3 39.3 1.73 189.71-0.41 379.52 1 569.33-1 20.51 2 43.26-9.75 61.44-14.83 10.76-34.12 9.34-51.48 10.16-101.56-0.51-203.11-0.31-304.77-0.31v101.55h-63.15C375.59 916.83 220.5 891 65.63 863.82q-0.15-355.4 0-710.69C222.34 126 379 98.39 535.94 71.69z" fill="#868695"/>
  <path d="M138.52 547.51V444.39h-34.1v-21h91.31v21h-34v103.12zM199 547.51l39.27-64.77-35.58-59.35h27.12l23 39.88 22.57-39.88h26.89l-35.74 60.28 39.27 63.84h-28l-25.4-42.92-25.55 42.92zM343.63 547.51V444.39h-34.1v-21h91.31v21h-34v103.12zM590.14 193.55v302.14h126.94v12.69H590.14v88.86h265.74v38.08H590.14v48.24h265.74v38.08H590.14V813h335.14V193.55z m198.11 250c-4.53 6.7-10.62 17.86-12.12 31.13a8.11 8.11 0 0 1-5.17 6.88l-43.83 15.86-4.93-2.57 20.22-27.09a15.45 15.45 0 0 0 5 0.79c7.84-0.08 14.14-5.95 14.07-13.09s-6.49-12.89-14.33-12.81-14.14 5.94-14.06 13.09a11.89 11.89 0 0 0 1 4.63 8.05 8.05 0 0 1-0.55 8.14l-17.15 23-4.09-3.82-0.13-42.48a8.25 8.25 0 0 1 4.66-7.51c6.93-3.32 20.19-10.74 30.28-22.81a8.22 8.22 0 0 1 10.81-1.46l28 18.43a8.35 8.35 0 0 1 2.32 11.72z m19.94-14.67a8.35 8.35 0 0 1-11 2l-42.74-26.63a8.35 8.35 0 0 1-2.52-11.73l0.32-0.47c2.53-3.77 4.47-1.64 8.3 0.8L802.93 420c4.13 2.61 8.25 5 5.25 8.91z m36.18-53.69l-24.11 35.7a13 13 0 0 1-18 3.48l-28.55-19.27a13 13 0 0 1-3.48-18l24.11-35.69a12.94 12.94 0 0 1 18-3.48l28.56 19.29a13 13 0 0 1 3.46 18z" fill="#FFFFFF"/>
</svg>
{:else if XML_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  class="w-9 h-9">
  <path d="M671.28289 0.000512a109.055945 109.055945 0 0 1 77.670361 32.255984l191.846304 191.539104c20.47999 20.68479 31.999984 48.588776 31.999984 77.670361v612.863694A109.670345 109.670345 0 0 1 863.129194 1024H160.870345A109.670345 109.670345 0 0 1 51.2 914.329655V109.670857C51.2 49.101287 100.300775 0.000512 160.870345 0.000512h510.463745zM181.247935 563.30263h-36.198382l87.449556 122.931139L138.239956 819.200102h36.198382l75.980762-109.670345L326.758262 819.200102h36.198382l-94.975952-132.966333 88.166356-122.931139h-36.198382l-69.529566 99.635151-69.171165-99.635151z m245.862277 0h-36.556782V819.200102h29.388786v-203.571098h1.075199L509.542171 819.200102h26.521587l88.524755-203.571098h1.0752V819.200102h29.388785v-255.897472h-36.556782l-94.975952 218.265491h-1.0752l-95.334352-218.265491z m308.582246 0h-29.030386V819.200102h177.049512v-25.446387h-148.019126v-230.451085z m-47.974376-446.463776a25.599987 25.599987 0 0 0-7.475197 18.124791v138.29113a25.599987 25.599987 0 0 0 25.599988 25.599988h138.291131a25.599987 25.599987 0 0 0 18.12479-43.724779l-138.34233-138.23993a25.599987 25.599987 0 0 0-36.198382 0z" fill="#1C75FF"/>
</svg>
{:else}
<svg
	xmlns="http://www.w3.org/2000/svg"
	viewBox="0 0 24 24"
	fill="currentColor"
	class="w-6 h-6"
	>
		<path
			fill-rule="evenodd"
			d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"
			clip-rule="evenodd"/>
		<path
			d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"
		/>
	</svg>
{/if}
