<script lang="ts">
  export let filename: string = "other";

  // 使用正则表达式提取后缀（更健壮）
  $: fileExt = filename ? (filename.match(/\.([^.]+)$/)?.[1]?.toLowerCase() || "") : "";

  // 预定义支持的扩展名集合（便于维护）
  const DOC_EXTS = new Set(["doc", "docx"]);
  const PPT_EXTS = new Set(["ppt", "pptx"]);
  const PDF_EXTS = new Set(["pdf"]);
  const EXCEL_EXTS = new Set(["xls", "xlsx"]);
  const MD_EXTS = new Set(["md"]);
  const TXT_EXTS = new Set(["txt"]);
</script>

{#if DOC_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024"
  fill="currentColor"
  class="w-6 h-6">
  <path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2zM512 566.095l52.814 197.012a12 12 0 0 0 11.59 8.893h31.78a12 12 0 0 0 11.587-8.878l74.375-276a12 12 0 0 0 0.413-3.122c0-6.627-5.373-12-12-12h-35.576a12 12 0 0 0-11.695 9.31l-45.79 199.105-49.76-199.321A12 12 0 0 0 528.097 472h-32.192a12 12 0 0 0-11.643 9.094l-49.66 198.927-46.096-198.732a12 12 0 0 0-11.69-9.289h-35.381a12 12 0 0 0-3.115 0.411c-6.4 1.72-10.194 8.303-8.474 14.703l74.173 276A12 12 0 0 0 415.606 772h31.99a12 12 0 0 0 11.59-8.893L512 566.095z" data-spm-anchor-id="a313x.search_index.0.i27.112b3a81MWchoD" class="selected"/>
</svg>
{:else if PPT_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024" 
  fill="currentColor"
	class="w-6 h-6">
  <path d="M874.660373 301.651825L597.328427 21.333227a77.226281 77.226281 0 0 0-14.506594-11.519943l-4.266646-2.133322h-2.986652A71.679642 71.679642 0 0 0 546.128683 0H200.957075A72.959635 72.959635 0 0 0 127.99744 72.106306v879.782268A72.959635 72.959635 0 0 0 200.957075 1023.99488h622.930219A71.252977 71.252977 0 0 0 895.9936 951.888574V352.424905a71.679642 71.679642 0 0 0-21.333227-50.77308z m-225.705538 308.905122a136.959315 136.959315 0 0 1-146.772599 110.506114h-37.546479l-18.77324 119.039405H368.636237L426.662613 506.024137h111.359444c70.826313 0 125.012708 25.173207 110.932778 104.53281z m-65.706338-298.665173V110.506114l200.958995 201.812324z" fill="#ffffff" p-id="25381"></path><path d="M523.515462 567.037165h-31.573175l-16.213252 93.012868h33.706498a57.599712 57.599712 0 0 0 64.426344-49.493086c5.546639-32.426505-13.226601-43.519782-50.346415-43.519782z"/>
</svg>
{:else if PDF_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024" 
  fill="currentColor"
  class="w-6 h-6">
  <path d="M491.8 512.2c-10-32-9.8-93.8-4-93.8 16.8 0 15.2 73.8 4 93.8z m-3.4 94.4c-15.4 40.4-34.6 86.6-56.8 125.4 36.6-14 78-34.4 125.8-43.8-25.4-19.2-49.8-46.8-69-81.6zM300.2 856.2c0 1.6 26.4-10.8 69.8-80.4-13.4 12.6-58.2 49-69.8 80.4zM624 320h272v656c0 26.6-21.4 48-48 48H176c-26.6 0-48-21.4-48-48V48C128 21.4 149.4 0 176 0h400v272c0 26.4 21.6 48 48 48z m-16 343.6c-40-24.4-66.6-58-85.4-107.6 9-37 23.2-93.2 12.4-128.4-9.4-58.8-84.8-53-95.6-13.6-10 36.6-0.8 88.2 16.2 154-23.2 55.2-57.4 129.2-81.6 171.6-0.2 0-0.2 0.2-0.4 0.2-54.2 27.8-147.2 89-109 136 11.2 13.8 32 20 43 20 35.8 0 71.4-36 122.2-123.6 51.6-17 108.2-38.2 158-46.4 43.4 23.6 94.2 39 128 39 58.4 0 62.4-64 39.4-86.8-27.8-27.2-108.6-19.4-147.2-14.4zM882 210L686 14c-9-9-21.2-14-34-14h-12v256h256v-12.2c0-12.6-5-24.8-14-33.8z m-148.2 510.6c8.2-5.4-5-23.8-85.6-18 74.2 31.6 85.6 18 85.6 18z"/>
</svg>
{:else if EXCEL_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024" 
  fill="currentColor"
  class="w-6 h-6">
  <path d="M640 42.7H170.7c-23.6 0-42.7 19.1-42.7 42.7v853.3c0 23.6 19.1 42.7 42.7 42.7h682.7c23.6 0 42.7-19.1 42.7-42.7v-640C796 198.7 740 142.6 640 42.7z m-2 768.8l-126-176-126 176h-86l164-218-150-214h84l114 172 114-172h84l-150 214 164 218h-86z m2-512.8V128l170.7 170.7H640z"/>
</svg>
{:else if MD_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024" 
  fill="currentColor"
  class="w-6 h-6">
  <path d="M854.592 288.64a32 32 0 0 1 9.408 22.656V928a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32v-832A32 32 0 0 1 192 64h424.704c8.512 0 16.64 3.392 22.72 9.408l215.168 215.296z m-64.384 37.376l-188.16-188.16v188.16h188.16zM426.112 600.96l59.136 132.928c2.56 5.76 8.32 9.536 14.592 9.536h24.064a16 16 0 0 0 14.656-9.536l59.072-133.376v157.44c0 8.896 7.168 16 16 16h27.392a16 16 0 0 0 16-16v-272a16 16 0 0 0-16-16h-34.752a16 16 0 0 0-14.72 9.664l-79.424 182.592L432.64 479.616a16 16 0 0 0-14.72-9.6h-34.944a16 16 0 0 0-16 16v272c0 8.832 7.168 16 16 16h27.136a16 16 0 0 0 16-16V600.96z"/>
</svg>
{:else if TXT_EXTS.has(fileExt)}
<svg 
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1024 1024" 
  fill="currentColor"
  class="w-6 h-6">
  <path d="M640 42.7H170.7c-23.6 0-42.7 19.1-42.7 42.7v853.3c0 23.6 19.1 42.7 42.7 42.7h682.7c23.6 0 42.7-19.1 42.7-42.7v-640C796 198.7 740 142.6 640 42.7z m52.2 384.8H546V809h-66.4V427.5H332.8v-57.1h359.4v57.1zM640 298.7V128l170.7 170.7H640z"/>
</svg>
{:else}
<svg
	xmlns="http://www.w3.org/2000/svg"
	viewBox="0 0 24 24"
	fill="currentColor"
	class="w-6 h-6"
	>
		<path
			fill-rule="evenodd"
			d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"
			clip-rule="evenodd"/>
		<path
			d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"
		/>
	</svg>
{/if}
